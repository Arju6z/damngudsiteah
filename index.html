<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SYSTEM // VOID</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Inter,system-ui,sans-serif;
}

body{
  background:#000;
  color:#d8d8d8;
  overflow:hidden;
  height:100vh;
}

/* Canvas layers */
canvas{
  position:fixed;
  inset:0;
}

/* Film grain */
#grain{
  pointer-events:none;
  opacity:.05;
  mix-blend-mode:overlay;
}

/* Center text container */
#overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}

#text{
  text-align:center;
  font-size:14px;
  letter-spacing:.15em;
  text-transform:uppercase;
  opacity:0;
  transition:opacity 3s ease;
}

/* Cursor entity */
#cursor{
  position:fixed;
  width:12px;
  height:12px;
  border-radius:50%;
  background:#fff;
  pointer-events:none;
  mix-blend-mode:difference;
  transform:translate(-50%,-50%);
}
</style>
</head>

<body>

<canvas id="void"></canvas>
<canvas id="grain"></canvas>
<div id="cursor"></div>

<div id="overlay">
  <div id="text"></div>
</div>

<script>
/* =========================
   GLOBAL STATE
========================= */
const STATE = {
  time: 0,
  phase: 0,
  interacted: false
};

/* =========================
   VOID CANVAS
========================= */
const canvas = document.getElementById("void");
const ctx = canvas.getContext("2d");
resize();

let particles = [];
for(let i=0;i<300;i++){
  particles.push({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height,
    z:Math.random(),
    v:Math.random()*0.2+0.05
  });
}

function drawVoid(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#000";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  particles.forEach(p=>{
    p.y += p.v * (1 + p.z*2);
    if(p.y > canvas.height) p.y = 0;

    const alpha = 0.2 + p.z*0.6;
    ctx.fillStyle = `rgba(255,255,255,${alpha})`;
    ctx.fillRect(p.x, p.y, 1+p.z, 1+p.z);
  });

  requestAnimationFrame(drawVoid);
}
drawVoid();

/* =========================
   FILM GRAIN
========================= */
const grain = document.getElementById("grain");
const gctx = grain.getContext("2d");
resize();

function drawGrain(){
  const img = gctx.createImageData(grain.width, grain.height);
  for(let i=0;i<img.data.length;i+=4){
    const v = Math.random()*255;
    img.data[i] = v;
    img.data[i+1] = v;
    img.data[i+2] = v;
    img.data[i+3] = 15;
  }
  gctx.putImageData(img,0,0);
  requestAnimationFrame(drawGrain);
}
drawGrain();

/* =========================
   CURSOR ENTITY
========================= */
const cursor = document.getElementById("cursor");
let cx=0, cy=0, tx=0, ty=0;

window.addEventListener("mousemove",e=>{
  tx=e.clientX;
  ty=e.clientY;
  STATE.interacted = true;
});

function moveCursor(){
  cx += (tx-cx)*0.08;
  cy += (ty-cy)*0.08;
  cursor.style.left = cx+"px";
  cursor.style.top = cy+"px";
  requestAnimationFrame(moveCursor);
}
moveCursor();

/* =========================
   TEXT SYSTEM
========================= */
const text = document.getElementById("text");

const SCRIPT = [
  { t: 5,  msg: "INITIALIZING" },
  { t: 12, msg: "SIGNAL DETECTED" },
  { t: 20, msg: "OBSERVING" },
  { t: 35, msg: "YOU ARE NOT REQUIRED TO INTERACT" },
  { t: 55, msg: "BUT YOU WILL" }
];

let shown = -1;

function updateText(){
  STATE.time++;
  const entry = SCRIPT.find((s,i)=> i>shown && STATE.time >= s.t);
  if(entry){
    text.textContent = entry.msg;
    text.style.opacity = 1;
    shown++;
  }
}

/* =========================
   TIME ENGINE
========================= */
setInterval(()=>{
  STATE.time++;
  updateText();

  if(STATE.time === 90){
    text.textContent = "PHASE ONE COMPLETE";
    text.style.opacity = 1;
  }
},1000);

/* =========================
   RESIZE
========================= */
function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  grain.width = innerWidth;
  grain.height = innerHeight;
}
window.addEventListener("resize",resize);
</script>

</body>
</html>
